function insertImage(){var e,t,i;detectPlugin("rasimage"),e=$(getIframe()).contents().find('input[name="selectedImage"]').data();var n=renderPluginContent($(getIframe()).contents().find("#lightbox").prop("checked"),e);t='<div class="mceNonEditable pluginContainer imagePlugin '+size+'" data-image-id="'+e.imageid+'">',t+=n,t+='<span class="mceEditable image-plugin-description">'+e.alt+", Foto: "+e.photographer+"</span>",t+="</div>",t+="<br />";var a=new tinymce.dom.ScriptLoader;a.add("/resources/js/adaptive/jquery-picture.js?v=2"),a.loadQueue(function(){editorGlobal.insertContent(t),popup.close(),$("figure.editorPlugin").ready(function(){$(i).find("figure");$("iframe").contents().find("figure").picture()})})}function renderPluginContent(e,t){var i;return e?i='<a class="image-link" data-title="'+t.alt+'" title="'+t.alt+'" data-lightbox="singleImage-set" href="'+t.pathname3+'"> <img class="editorPlugin" src="'+t.pathname2+'" alt="'+t.alt+'" /></a>':(i='<figure class="editorPlugin" title="'+t.alt+'"',i+='data-media="'+t.pathname1+'"',i+='data-media440="'+t.pathname2+'"',1===t.size?(size="halfWidth",i+='data-media900="'+t.pathname1+'">'):i+='data-media900="'+t.pathname3+'">',i+='</figure><noscript><img class="editorPlugin" src="'+t.pathname1+'" alt="'+t.alt+'" /></noscript>'),i}const SELECTED_IMAGE_CLASS="selectedImage",IMAGES_URL=tinymce.baseURL+"/../../../media/browse?context=2&t="+Math.random();var size="fullWidth";tinymce.PluginManager.add("rasimage",function(e,t){function i(e){var t,i;t=n(),i={window:window,editor_id:e.editor_id,popup:t},popup=e.windowManager.open(t,i),e.windowManager.setParams(t)}function n(){var e=9*$(window).height()/10;return e>700&&(e=700),{file:IMAGES_URL,title:"Insert image",width:9*$(window).width()/10,height:e,close_previous:"no",resizable:"yes",onInit:function(){init()}}}e.addButton("rasimage",{text:"Insert image",icon:"none",image:t+"../../../../../css/images/ikonica.png",tooltip:"Insert image",shortcut:"Ctrl+e",stateSelector:"div[data-image-id]",onclick:function(){i(e)}}),e.addMenuItem("rasimage",{text:"Edit plugin",icon:"edit",onPostRender:function(){handleDisabledState(this,"div.imagePlugin")},context:"delete",prependToContext:!0,menu:[{text:"Insert new image",onclick:function(){e.focus(),i(e)},context:"insert"},{text:"Remove image",onclick:function(){deletePlugin(".imagePlugin")},context:"delete"}]}),editorGlobal=e});
