var embedCodeContainer="",intervalId="",savedParagraph="";tinymce.PluginManager.add("raspost",function(e,t){function o(e){var t,o;t=i(),o={window:window,editor_id:e.editor_id,popup:t},t.scrollbars=!0,popup=e.windowManager.open(t,o),$(popup.getEl()).find("#embedPost").on("input",function(){s()})}function i(){var e,t='<div style="float:left;width:30%;margin-right:40px;height:500px"><textarea id="embedPost" style="border:solid 1px lightgray;width:100%;height:100%" name="embedPost"></textarea></div><div id="previewPost" style="float:left;height:100%;"></div>';return e={title:"Embed post",width:900,height:550,close_previous:"no",resizable:"yes",autoscroll:"yes",body:[{title:"Embed form",type:"panel",html:t}],buttons:[{text:"Close",onclick:function(){tinymce.activeEditor.windowManager.close()}},{text:"Insert",onclick:function(e){n()}}]}}function n(){if(detectPlugin("raspost"),""!==$("#embedPost").val()){var e='<div class="mceNonEditable pluginContainer postPlugin embed-responsive clearfix '+d($("#embedPost").val())+'" data-post-plugin="1">';e+="cocaColaPost"===d($("#embedPost").val())?'<img src="'+$("#embedPost").val()+'" width="100%" alt="coca cola">':$("#embedPost").val(),e+="</div>",e+="<br />",editorGlobal.insertContent(e)}popup.close()}function d(e){var t="unknown notSelfResponsive";return-1!==e.indexOf("facebook")?t="facebookPost":-1!==e.indexOf("twitter-tweet")?t="twitterPost":-1!==e.indexOf("imgur.com")?t="imgurPost":-1!==e.indexOf("instagram")?t="instagramPost":-1!==e.indexOf("mvp")?t="onetVideo":-1!==e.indexOf("d2ue81d0nkdkc0.cloudfront.net")&&-1!==e.indexOf("/image.gif")?t="cocaColaPost notSelfResponsive":-1!==e.indexOf("vine")?t="vinePost":e.indexOf("giphy")?t="giphyPost notSelfResponsive":-1!==e.indexOf("vimeo")?t="vimeoPost":-1!==e.indexOf("vine.co")?t="vinePost":(-1!==e.indexOf("you.")||-1!==e.indexOf("youtube"))&&(t="youtubePost"),t}function s(){embedCodeContainer=$("#embedPost").val(),$("#previewPost").html(embedCodeContainer)}e.addButton("raspost",{icon:"",text:"Embed post",tooltip:"Embed post",stateSelector:"div[data-post-plugin]",onclick:function(){o(e)}}),e.addMenuItem("raspost",{text:"Edit plugin",onPostRender:function(){handleDisabledState(this,"div.postPlugin")},context:"delete",prependToContext:!0,menu:[{text:"Edit this post",onclick:function(){e.focus(),o(e)},context:"insert"},{text:"Remove post",onclick:function(){deletePlugin("postPlugin")},context:"delete"}]})});